(function(){this.SynthView=function(){function t(t,e){this.model=t,this.id=e,this.dom=$("#tmpl_synth").clone(),this.dom.attr("id","synth"+e),$("#instruments").append(this.dom),this.synth_name=this.dom.find(".synth-name"),this.synth_name.val(this.model.name),this.pattern_name=this.dom.find(".pattern-name"),this.pattern_name.val(this.model.pattern_name),this.synth_type=this.dom.find(".synth-type"),this.pencil=this.dom.find(".sequencer-pencil"),this.step=this.dom.find(".sequencer-step"),this.is_step=!1,this.header=this.dom.find(".header"),this.markers=this.dom.find(".markers"),this.pos_markers=this.dom.find(".marker"),this.marker_prev=this.dom.find(".marker-prev"),this.marker_next=this.dom.find(".marker-next"),this.plus=this.dom.find(".pattern-plus"),this.minus=this.dom.find(".pattern-minus"),this.nosync=this.dom.find(".pattern-nosync"),this.is_nosync=!1,this.setMarker(),this.table_wrapper=this.dom.find(".sequencer-table"),this.canvas_hover_dom=this.dom.find(".table-hover"),this.canvas_on_dom=this.dom.find(".table-on"),this.canvas_off_dom=this.dom.find(".table-off"),this.canvas_hover=this.canvas_hover_dom[0],this.canvas_on=this.canvas_on_dom[0],this.canvas_off=this.canvas_off_dom[0],this.ctx_hover=this.canvas_hover.getContext("2d"),this.ctx_on=this.canvas_on.getContext("2d"),this.ctx_off=this.canvas_off.getContext("2d"),this.cell=new Image,this.cell.src="static/img/sequencer_cell.png",this.cell.onload=function(t){return function(){return t.initCanvas()}}(this),this.cells_x=32,this.cells_y=20,this.btn_fold=this.dom.find(".btn-fold-core"),this.core=this.dom.find(".synth-core"),this.is_panel_opened=!0,this.btn_fx=this.dom.find(".btn-fx-view"),this.fx=this.dom.find(".synth-fx"),this.is_fx_view=!1,this.keyboard=new KeyboardView(this),this.pattern=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.pattern_obj={name:this.model.pattern_name,pattern:this.pattern},this.page=0,this.page_total=1,this.last_time=0,this.last_page=0,this.is_clicked=!1,this.hover_pos={x:-1,y:-1},this.click_pos={x:-1,y:-1},this.initEvent()}return t.prototype.initCanvas=function(){var t,e,s,i,n,r;for(this.canvas_hover.width=this.canvas_on.width=this.canvas_off.width=832,this.canvas_hover.height=this.canvas_on.height=this.canvas_off.height=520,this.rect=this.canvas_off.getBoundingClientRect(),this.offset={x:this.rect.left,y:this.rect.top},t=s=0,n=this.cells_y;n>=0?n>s:s>n;t=n>=0?++s:--s)for(e=i=0,r=this.cells_x;r>=0?r>i:i>r;e=r>=0?++i:--i)this.ctx_off.drawImage(this.cell,0,0,26,26,26*e,26*t,26,26);return this.setPattern(this.pattern_obj)},t.prototype.getPos=function(t){var e,s;return this.rect=this.canvas_off.getBoundingClientRect(),e=Math.floor((t.clientX-this.rect.left)/26),s=Math.floor((t.clientY-this.rect.top)/26),{x:e,y:s,x_abs:this.page*this.cells_x+e,y_abs:s,note:this.cells_y-s}},t.prototype.initEvent=function(){return this.canvas_hover_dom.on("mousemove",function(t){return function(e){var s;return s=t.getPos(e),s!==t.hover_pos&&(t.ctx_hover.clearRect(26*t.hover_pos.x,26*t.hover_pos.y,26,26),t.ctx_hover.drawImage(t.cell,52,0,26,26,26*s.x,26*s.y,26,26),t.hover_pos=s),t.is_clicked&&t.click_pos!==s?(t.is_sustaining?(t.sustain_l=Math.min(s.x_abs,t.sustain_l),t.sustain_r=Math.max(s.x_abs,t.sustain_r),t.sustainNote(t.sustain_l,t.sustain_r,s)):t.is_adding?t.addNote(s):t.pattern[s.x_abs]===s.note&&t.removeNote(s),t.click_pos=s):void 0}}(this)).on("mousedown",function(t){return function(e){var s;return t.is_clicked=!0,s=t.getPos(e),t.is_step?t.pattern[s.x_abs]===s.note?t.removeNote(s):(t.is_adding=!0,t.addNote(s)):"sustain"===t.pattern[s.x_abs]||"end"===t.pattern[s.x_abs]?(t.addNote(s),t.sustain_l=t.sustain_r=s.x_abs,t.is_sustaining=!0):(t.addNote(s),t.sustain_l=t.sustain_r=s.x_abs,t.is_sustaining=!0)}}(this)).on("mouseup",function(t){return function(e){var s;return t.is_clicked=!1,t.is_step?t.is_adding=!1:(s=t.getPos(e),t.is_sustaining=!1)}}(this)).on("mouseout",function(t){return function(){return t.ctx_hover.clearRect(26*t.hover_pos.x,26*t.hover_pos.y,26,26),t.hover_pos={x:-1,y:-1},t.is_clicked=!1,t.is_adding=!1}}(this)),this.synth_type.on("change",function(t){return function(){return t.model.changeSynth(t.synth_type.val())}}(this)),this.synth_name.on("focus",function(){return function(){return window.keyboard.beginInput()}}(this)).on("blur",function(){return function(){return window.keyboard.endInput()}}(this)).on("change",function(t){return function(){return t.model.setSynthName(t.synth_name.val())}}(this)),this.pattern_name.on("focus",function(){return function(){return window.keyboard.beginInput()}}(this)).on("blur",function(){return function(){return window.keyboard.endInput()}}(this)).on("change",function(t){return function(){return t.model.inputPatternName(t.pattern_name.val())}}(this)),this.pencil.on("click",function(t){return function(){return t.pencilMode()}}(this)),this.step.on("click",function(t){return function(){return t.stepMode()}}(this)),this.marker_prev.on("click",function(t){return function(){return t.model.player.backward(!0)}}(this)),this.marker_next.on("click",function(t){return function(){return t.model.player.forward()}}(this)),this.nosync.on("click",function(t){return function(){return t.toggleNoSync()}}(this)),this.plus.on("click",function(t){return function(){return t.plusPattern()}}(this)),this.minus.on("click",function(t){return function(){return t.pattern.length>t.cells_x?t.minusPattern():void 0}}(this)),this.btn_fold.on("mousedown",function(t){return function(){return t.is_panel_opened?(t.core.css("height","0px"),t.table_wrapper.css("height","524px"),t.btn_fold.css({top:"-22px",padding:"0px 5px 0px 0px"}).removeClass("fa-angle-down").addClass("fa-angle-up"),t.is_panel_opened=!1):(t.core.css("height","280px"),t.table_wrapper.css("height","262px"),t.btn_fold.css({top:"0px",padding:"5px 5px 5px 5px"}).removeClass("fa-angle-up").addClass("fa-angle-down"),t.is_panel_opened=!0)}}(this)),this.btn_fx.on("mousedown",function(t){return function(){return t.is_fx_view?t.is_fx_view=!1:(t.core.css("height","280px"),t.table_wrapper.css("height","262px"),t.btn_fold.css({top:"0px",padding:"5px 5px 5px 5px"}).removeClass("fa-angle-up").addClass("fa-angle-down"),t.is_panel_opened=!0)}}(this))},t.prototype.addNote=function(t){var e,s;if("end"===this.pattern[t.x_abs]||"sustain"===this.pattern[t.x_abs]){for(e=t.x_abs-1;"sustain"===this.pattern[e]||"end"===this.pattern[e];)e--;this.ctx_on.clearRect((t.x_abs-1)%this.cells_x*26,0,26,1e3),s=this.cells_y+this.pattern[e],this.pattern[t.x_abs-1]<0?(this.pattern[t.x_abs-1]=-this.pattern[t.x_abs-1],this.ctx_on.drawImage(this.cell,0,0,26,26,(t.x_abs-1)%this.cells_x*26,26*s,26,26)):(this.pattern[t.x_abs-1]="end",this.ctx_on.drawImage(this.cell,156,0,26,26,(t.x_abs-1)%this.cells_x*26,26*s,26,26))}for(e=t.x_abs+1;"end"===this.pattern[e]||"sustain"===this.pattern[e];)this.pattern[e]=0,e++;return this.ctx_on.clearRect(26*t.x,0,26*(e-t.x_abs),1e3),this.pattern[t.x_abs]=t.note,this.model.addNote(t.x_abs,t.note),this.ctx_on.clearRect(26*t.x,0,26,1e3),this.ctx_on.drawImage(this.cell,26,0,26,26,26*t.x,26*t.y,26,26)},t.prototype.removeNote=function(t){return this.pattern[t.x_abs]=0,this.ctx_on.clearRect(26*t.x,26*t.y,26,26),this.model.removeNote(t.x_abs)},t.prototype.sustainNote=function(t,e,s){var i,n,r,a,o;if(t===e)return void this.addNote(s);for(i=r=t;e>=t?e>=r:r>=e;i=e>=t?++r:--r)this.ctx_on.clearRect(i%this.cells_x*26,0,26,1e3);for(i=a=o=t+1;e>=o?e>a:a>e;i=e>=o?++a:--a)this.pattern[i]="sustain",this.ctx_on.drawImage(this.cell,130,0,26,26,i%this.cells_x*26,26*s.y,26,26);if("sustain"===this.pattern[t]||"end"===this.pattern[t]){for(i=t-1;"sustain"===this.pattern[i]||"end"===this.pattern[i];)i--;this.ctx_on.clearRect((t-1)%this.cells_x*26,0,26,1e3),n=this.cells_y+this.pattern[i],this.pattern[t-1]<0?(this.pattern[t-1]=-this.pattern[t-1],this.ctx_on.drawImage(this.cell,0,0,26,26,(t-1)%this.cells_x*26,26*n,26,26)):(this.pattern[t-1]="end",this.ctx_on.drawImage(this.cell,156,0,26,26,(t-1)%this.cells_x*26,26*n,26,26))}return this.pattern[e]<0&&(n=this.cells_y+this.pattern[e],"end"===this.pattern[e+1]?(this.pattern[e+1]=-this.pattern[e],this.ctx_on.drawImage(this.cell,26,0,26,26,(e+1)%this.cells_x*26,26*n,26,26)):(this.pattern[e+1]=this.pattern[e],this.ctx_on.drawImage(this.cell,104,0,26,26,(e+1)%this.cells_x*26,26*n,26,26))),this.pattern[t]=-s.note,this.pattern[e]="end",this.ctx_on.drawImage(this.cell,104,0,26,26,t%this.cells_x*26,26*s.y,26,26),this.ctx_on.drawImage(this.cell,156,0,26,26,e%this.cells_x*26,26*s.y,26,26),this.model.sustainNote(t,e,s.note)},t.prototype.endSustain=function(t){return this.is_sustaining?("sustain"===this.pattern[t-1]?this.pattern[t-1]="end":this.pattern[t-1]*=-1,this.is_sustaining=!1):void 0},t.prototype.playAt=function(t){var e,s,i;if(this.time=t,!this.is_nosync){for(this.time%this.cells_x===0&&(this.endSustain(),this.drawPattern(this.time)),e=s=0,i=this.cells_y;i>=0?i>s:s>i;e=i>=0?++s:--s)this.ctx_off.drawImage(this.cell,0,0,26,26,this.last_time%this.cells_x*26,26*e,26,26),this.ctx_off.drawImage(this.cell,78,0,26,26,t%this.cells_x*26,26*e,26,26);return this.last_time=t}},t.prototype.setPattern=function(t){return this.pattern_obj=t,this.pattern=this.pattern_obj.pattern,this.page=0,this.page_total=this.pattern.length/this.cells_x,this.drawPattern(0),this.setMarker(),this.setPatternName(this.pattern_obj.name)},t.prototype.drawPattern=function(t){var e,s,i,n,r,a;for(null!=t&&(this.time=t),this.page=Math.floor(this.time/this.cells_x),this.ctx_on.clearRect(0,0,832,520),s=0,e=r=0,a=this.cells_x;a>=0?a>r:r>a;e=a>=0?++r:--r)i=this.pattern[this.page*this.cells_x+e],"sustain"===i?this.ctx_on.drawImage(this.cell,130,0,26,26,26*e,26*s,26,26):"end"===i?(this.ctx_on.drawImage(this.cell,156,0,26,26,26*e,26*s,26,26),s=0):0>i?(n=this.cells_y+i,this.ctx_on.drawImage(this.cell,104,0,26,26,26*e,26*n,26,26),s=n):(n=this.cells_y-i,this.ctx_on.drawImage(this.cell,26,0,26,26,26*e,26*n,26,26),s=n);return this.setMarker()},t.prototype.plusPattern=function(){return 8!==this.page_total?(this.pattern=this.pattern.concat([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),this.page_total++,this.model.plusPattern(),this.drawPattern(),this.minus.removeClass("btn-false").addClass("btn-true"),8===this.page_total?this.plus.removeClass("btn-true").addClass("btn-false"):void 0):void 0},t.prototype.minusPattern=function(){return 1!==this.page_total?(this.pattern=this.pattern.slice(0,this.pattern.length-this.cells_x),this.page_total--,this.model.minusPattern(),this.drawPattern(),this.plus.removeClass("btn-false").addClass("btn-true"),1===this.page_total?this.minus.removeClass("btn-true").addClass("btn-false"):void 0):void 0},t.prototype.setMarker=function(){return this.pos_markers.filter(function(t){return function(e){return e<t.page_total}}(this)).addClass("marker-active"),this.pos_markers.filter(function(t){return function(e){return t.page_total<=e}}(this)).removeClass("marker-active"),this.pos_markers.removeClass("marker-now").eq(this.page).addClass("marker-now"),this.markers.find(".marker-pos").text(this.page+1),this.markers.find(".marker-total").text(this.page_total),this.pos_markers.filter(function(t){return function(e){return e<t.page_total}}(this)).each(function(t){return function(e){return t.pos_markers.eq(e).on("mousedown",function(){var s;if(t.page<e)for(;t.page!==e;)t.model.player.forward();if(e<t.page){for(s=[];t.page!==e;)s.push(t.model.player.backward(!0));return s}})}}(this))},t.prototype.play=function(){},t.prototype.stop=function(){var t,e,s,i;for(i=[],t=e=0,s=this.cells_y;s>=0?s>e:e>s;t=s>=0?++e:--e)i.push(this.ctx_off.drawImage(this.cell,0,0,26,26,this.last_time%this.cells_x*26,26*t,26,26));return i},t.prototype.activate=function(){return this.is_active=!0,this.initCanvas()},t.prototype.inactivate=function(){return this.is_active=!1},t.prototype.setSynthName=function(t){return this.synth_name.val(t)},t.prototype.setPatternName=function(t){return this.pattern_name.val(t),this.pattern_obj.name=t},t.prototype.toggleNoSync=function(){var t,e,s,i;if(this.is_nosync)return this.is_nosync=!1,this.nosync.removeClass("btn-true").addClass("btn-false"),this.drawPattern(this.time);for(this.is_nosync=!0,this.nosync.removeClass("btn-false").addClass("btn-true"),i=[],t=e=0,s=this.cells_y;s>=0?s>e:e>s;t=s>=0?++e:--e)i.push(this.ctx_off.drawImage(this.cell,0,0,26,26,this.time%this.cells_x*26,26*t,26,26));return i},t.prototype.pencilMode=function(){return this.is_step=!1,this.pencil.removeClass("btn-false").addClass("btn-true"),this.step.removeClass("btn-true").addClass("btn-false")},t.prototype.stepMode=function(){return this.is_step=!0,this.step.removeClass("btn-false").addClass("btn-true"),this.pencil.removeClass("btn-true").addClass("btn-false")},t.prototype.changeScale=function(t){return this.keyboard.changeScale(t)},t}(),this.SynthCoreView=function(){function t(t,e,s){this.model=t,this.id=e,this.dom=s,this.vcos=$(this.dom.find(".RS_VCO")),this.EG_inputs=this.dom.find(".RS_EG input"),this.FEG_inputs=this.dom.find(".RS_FEG input"),this.filter_inputs=this.dom.find(".RS_filter input"),this.gain_inputs=this.dom.find(".RS_mixer input"),this.canvasEG=this.dom.find(".RS_EG .canvasEG").get()[0],this.canvasFEG=this.dom.find(".RS_FEG .canvasFEG").get()[0],this.contextEG=this.canvasEG.getContext("2d"),this.contextFEG=this.canvasFEG.getContext("2d"),this.initEvent()}return t.prototype.initEvent=function(){return this.vcos.on("change",function(t){return function(){return t.fetchVCOParam()}}(this)),this.gain_inputs.on("change",function(t){return function(){return t.fetchGains()}}(this)),this.filter_inputs.on("change",function(t){return function(){return t.fetchFilterParam()}}(this)),this.EG_inputs.on("change",function(t){return function(){return t.fetchEGParam()}}(this)),this.FEG_inputs.on("change",function(t){return function(){return t.fetchFEGParam()}}(this)),this.fetchParam()},t.prototype.updateCanvas=function(t){var e,s,i,n,r,a;return s=null,i=null,e=null,"EG"===t?(s=this.canvasEG,i=this.contextEG,e=this.model.eg.getADSR()):(s=this.canvasFEG,i=this.contextFEG,e=this.model.feg.getADSR()),r=s.width=180,n=s.height=50,a=r/4,i.clearRect(0,0,r,n),i.beginPath(),i.moveTo(a*(1-e[0]),n),i.lineTo(r/4,0),i.lineTo(a*(e[1]+1),n*(1-e[2])),i.lineTo(3*a,n*(1-e[2])),i.lineTo(a*(e[3]+3),n),i.strokeStyle="rgb(0, 220, 255)",i.stroke()},t.prototype.fetchParam=function(){return this.fetchVCOParam(),this.fetchEGParam(),this.fetchFEGParam(),this.fetchFilterParam(),this.fetchGains()},t.prototype.fetchVCOParam=function(){var t,e,s,i,n,r;for(t=this.vcos.eq(0).find(".harmony").val(),r=[],e=i=0,n=this.vcos.length;n>=0?n>i:i>n;e=n>=0?++i:--i)s=this.vcos.eq(e),r.push(this.model.setVCOParam(e,s.find(".shape").val(),parseInt(s.find(".octave").val()),parseInt(s.find(".interval").val()),parseInt(s.find(".fine").val()),t));return r},t.prototype.setVCOParam=function(t){var e,s,i,n,r;for(r=[],e=i=0,n=this.vcos.length;n>=0?n>i:i>n;e=n>=0?++i:--i)s=this.vcos.eq(e),s.find(".shape").val(t[e].shape),s.find(".octave").val(t[e].octave),s.find(".interval").val(t[e].interval),r.push(s.find(".fine").val(t[e].fine));return r},t.prototype.fetchEGParam=function(){return this.model.setEGParam(parseFloat(this.EG_inputs.eq(0).val()),parseFloat(this.EG_inputs.eq(1).val()),parseFloat(this.EG_inputs.eq(2).val()),parseFloat(this.EG_inputs.eq(3).val())),this.updateCanvas("EG")},t.prototype.setEGParam=function(t){return this.EG_inputs.eq(0).val(5e4*t.adsr[0]),this.EG_inputs.eq(1).val(5e4*t.adsr[1]),this.EG_inputs.eq(2).val(100*t.adsr[2]),this.EG_inputs.eq(3).val(5e4*t.adsr[3])},t.prototype.fetchFEGParam=function(){return this.model.setFEGParam(parseFloat(this.FEG_inputs.eq(0).val()),parseFloat(this.FEG_inputs.eq(1).val()),parseFloat(this.FEG_inputs.eq(2).val()),parseFloat(this.FEG_inputs.eq(3).val())),this.updateCanvas("FEG")},t.prototype.setFEGParam=function(t){var e,s,i,n;for(n=[],e=s=0,i=t.length;i>=0?i>s:s>i;e=i>=0?++s:--s)n.push(this.FEG_inputs.eq(e).val(t.adsr[e]));return n},t.prototype.fetchFilterParam=function(){return this.model.setFilterParam(parseFloat(this.filter_inputs.eq(0).val()),parseFloat(this.filter_inputs.eq(1).val()))},t.prototype.setFilterParam=function(t){return this.filter_inputs.eq(0).val(t[0]),this.filter_inputs.eq(1).val(t[1])},t.prototype.fetchGains=function(){var t,e,s,i;for(i=[],t=e=0,s=this.gain_inputs.length;s>=0?s>e:e>s;t=s>=0?++e:--e)i.push(this.model.setVCOGain(t,parseInt(this.gain_inputs.eq(t).val())));return i},t.prototype.setParam=function(t){var e,s,i;if(null!=t.vcos&&this.setVCOParam(t.vcos),null!=t.gains)for(e=s=0,i=t.gains.length;i>=0?i>s:s>i;e=i>=0?++s:--s)this.gain_inputs.eq(e).val(t.gains[e]/.3*100);return null!=t.eg&&this.setEGParam(t.eg),null!=t.feg&&this.setFEGParam(t.feg),null!=t.filter?this.setFilterParam(t.filter):void 0},t}(),this.KeyboardView=function(){function t(t){this.sequencer=t,this.dom=this.sequencer.dom.find(".keyboard"),this.canvas=this.dom[0],this.ctx=this.canvas.getContext("2d"),this.w=48,this.h=26,this.num=20,this.color=["rgba(230, 230, 230, 1.0)","rgba(  0, 220, 250, 0.7)","rgba(100, 230, 255, 0.7)","rgba(200, 200, 200, 1.0)","rgba(255, 255, 255, 1.0)"],this.is_clicked=!1,this.hover_pos={x:-1,y:-1},this.click_pos={x:-1,y:-1},this.scale=this.sequencer.model.scale,this.initCanvas(),this.initEvent()}return t.prototype.initCanvas=function(){var t,e,s,i;for(this.canvas.width=this.w,this.canvas.height=this.h*this.num,this.rect=this.canvas.getBoundingClientRect(),this.offset={x:this.rect.left,y:this.rect.top},this.ctx.fillStyle=this.color[0],i=[],t=e=0,s=this.num;s>=0?s>e:e>s;t=s>=0?++e:--e)i.push(this.drawNormal(t));return i},t.prototype.getPos=function(t){return this.rect=this.canvas.getBoundingClientRect(),Math.floor((t.clientY-this.rect.top)/this.h)},t.prototype.initEvent=function(){return this.dom.on("mousemove",function(t){return function(e){var s;return s=t.getPos(e),s!==t.hover_pos&&(t.drawNormal(t.hover_pos),t.drawHover(s),t.hover_pos=s),t.is_clicked&&t.click_pos!==s?(t.clearActive(t.click_pos),t.drawActive(s),t.sequencer.model.noteOff(!0),t.sequencer.model.noteOn(t.num-s,!0),t.click_pos=s):void 0}}(this)).on("mousedown",function(t){return function(e){var s;return t.is_clicked=!0,s=t.getPos(e),t.drawActive(s),t.sequencer.model.noteOn(t.num-s,!0),t.click_pos=s}}(this)).on("mouseup",function(t){return function(){return t.is_clicked=!1,t.clearActive(t.click_pos),t.sequencer.model.noteOff(!0),t.click_pos={x:-1,y:-1}}}(this)).on("mouseout",function(t){return function(){return t.clearActive(t.hover_pos),t.sequencer.model.noteOff(!0),t.hover_pos={x:-1,y:-1},t.click_pos={x:-1,y:-1}}}(this))},t.prototype.drawNormal=function(t){return this.clearNormal(t),this.ctx.fillStyle=this.color[0],this.isKey(t)&&this.ctx.fillRect(0,(t+1)*this.h-5,this.w,2),this.ctx.fillRect(0,(t+1)*this.h-3,this.w,2),this.ctx.fillStyle=this.color[3],this.ctx.fillText(this.text(t),10,(t+1)*this.h-10)},t.prototype.drawHover=function(t){return this.ctx.fillStyle=this.color[1],this.ctx.fillRect(0,(t+1)*this.h-3,this.w,2),this.isKey(t)&&this.ctx.fillRect(0,(t+1)*this.h-5,this.w,2),this.ctx.fillText(this.text(t),10,(t+1)*this.h-10)},t.prototype.drawActive=function(t){return this.clearNormal(t),this.ctx.fillStyle=this.color[2],this.ctx.fillRect(0,t*this.h,this.w,this.h),this.ctx.fillStyle=this.color[4],this.ctx.fillText(this.text(t),10,(t+1)*this.h-10)},t.prototype.clearNormal=function(t){return this.ctx.clearRect(0,t*this.h,this.w,this.h)},t.prototype.clearActive=function(t){return this.clearNormal(t),this.drawNormal(t)},t.prototype.changeScale=function(t){var e,s,i,n;for(this.scale=t,n=[],e=s=0,i=this.num;i>=0?i>s:s>i;e=i>=0?++s:--s)n.push(this.drawNormal(e));return n},t.prototype.text=function(t){return(this.num-t-1)%this.scale.length+1+"th"},t.prototype.isKey=function(t){return(this.num-t-1)%this.scale.length===0},t}()}).call(this);