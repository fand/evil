(function(){this.PlayerView=function(){function t(t){this.model=t,this.dom=$("#control"),this.bpm=this.dom.find("[name=bpm]"),this.key=this.dom.find("[name=key]"),this.scale=this.dom.find("[name=mode]"),this.footer=$("footer"),this.play=$("#control-play"),this.stop=$("#control-stop"),this.forward=$("#control-forward"),this.backward=$("#control-backward"),this.loop=$("#control-loop"),this.wrapper=$("#wrapper"),this.instruments=$("#instruments"),this.mixer=$("#mixer"),this.is_mixer=!1,this.btn_left=$("#btn-left"),this.btn_right=$("#btn-right"),this.btn_top=$("#btn-top"),this.btn_bottom=$("#btn-bottom"),this.synth_now=0,this.synth_total=1,this.initEvent(),this.resize()}return t.prototype.initEvent=function(){return this.dom.on("change",function(t){return function(){return t.model.setBPM(parseInt(t.bpm.val())),t.model.setKey(t.key.val()),t.model.setScale(t.scale.val())}}(this)),this.bpm.on("focus",function(){return function(){return window.keyboard.beginInput()}}(this)).on("blur",function(){return function(){return window.keyboard.endInput()}}(this)),this.key.on("focus",function(){return function(){return window.keyboard.beginInput()}}(this)).on("blur",function(){return function(){return window.keyboard.endInput()}}(this)),this.scale.on("focus",function(){return function(){return window.keyboard.beginInput()}}(this)).on("blur",function(){return function(){return window.keyboard.endInput()}}(this)),this.play.on("mousedown",function(t){return function(){return t.viewPlay()}}(this)),this.stop.on("mousedown",function(t){return function(){return t.viewStop(t.model)}}(this)),this.forward.on("mousedown",function(t){return function(){return t.model.forward()}}(this)),this.backward.on("mousedown",function(t){return function(){return t.model.backward()}}(this)),this.loop.on("mousedown",function(t){return function(){return t.model.toggleLoop()?t.loop.removeClass("control-off").addClass("control-on"):t.loop.removeClass("control-on").addClass("control-off")}}(this)),this.btn_left.on("mousedown",function(t){return function(){return t.moveLeft()}}(this)),this.btn_right.on("mousedown",function(t){return function(){return t.moveRight()}}(this)),this.btn_top.on("mousedown",function(t){return function(){return t.moveTop()}}(this)),this.btn_bottom.on("mousedown",function(t){return function(){return t.moveBottom()}}(this)),$(window).on("resize",function(t){return function(){return t.resize()}}(this))},t.prototype.viewPlay=function(){return this.model.isPlaying()?(this.model.pause(),this.play.removeClass("fa-pause").addClass("fa-play")):(this.model.play(),this.play.removeClass("fa-play").addClass("fa-pause"))},t.prototype.viewStop=function(t){return null!=t&&t.stop(),this.play.removeClass("fa-pause").addClass("fa-play")},t.prototype.setBPM=function(t){return this.bpm.val(t)},t.prototype.setScale=function(t){return this.scale.val(t)},t.prototype.setKey=function(t){var n,o,i;i=[];for(n in KEY_LIST){if(o=KEY_LIST[n],o=t){this.key.val(n);break}i.push(void 0)}return i},t.prototype.setParam=function(t,n,o){return this.setBPM(t),this.setKey(n),this.setScale(o)},t.prototype.moveRight=function(){return this.is_mixer?void 0:(this.synth_now++,this.model.moveRight(this.synth_now),this.synth_total=this.model.synth.length,this.instruments.css("-webkit-transform","translate3d("+-1110*this.synth_now+"px, 0px, 0px)"),this.btn_left.show(),this.synth_now===this.synth_total-1?this.btn_right.attr("data-line1","new"):void 0)},t.prototype.moveLeft=function(){return this.is_mixer?void 0:(this.synth_total=this.model.synth.length,this.btn_right.attr("data-line1","next"),0!==this.synth_now&&(this.synth_now--,this.instruments.css("-webkit-transform","translate3d("+-1110*this.synth_now+"px, 0px, 0px)"),this.model.moveLeft(this.synth_now)),0===this.synth_now?this.btn_left.hide():void 0)},t.prototype.moveTop=function(){return this.is_mixer=!0,this.btn_left.hide(),this.btn_right.hide(),this.btn_top.hide(),this.btn_bottom.show(),this.wrapper.css("-webkit-transform","translate3d(0px, 700px, 0px)"),this.model.moveTop()},t.prototype.moveBottom=function(){return this.is_mixer=!1,0!==this.synth_now&&this.btn_left.show(),this.btn_right.show(),this.btn_top.show(),this.btn_bottom.hide(),this.wrapper.css("-webkit-transform","translate3d(0px, 0px, 0px)"),this.model.moveBottom()},t.prototype.setSynthNum=function(t,n){return this.synth_total=t,t-1>n?this.btn_right.attr("data-line1","next"):void 0},t.prototype.resize=function(){var t,n,o,i,s,e;return e=$(window).width(),t=$(window).height(),s=(e-910)/2,i=(t-600)/2,o=s/2-50,n=i/2-50,this.btn_left.css({width:s+"px",padding:"250px 25px"}),this.btn_right.css({width:s+"px",padding:"250px 35px"}),this.btn_top.css({height:i+"px"}),this.btn_bottom.css({bottom:i+"px",height:"100px"}),this.footer.css({height:i+"px"})},t.prototype.changeSynth=function(){return 0===this.synth_now&&this.btn_left.hide(),this.synth_now===this.synth_total-1?this.btn_right.attr("data-line1","new"):void 0},t.prototype.empty=function(){return this.instruments.empty()},t}()}).call(this);