(function(){var t=[].indexOf||function(t){for(var e=0,i=this.length;i>e;e++)if(e in this&&this[e]===t)return e;return-1};this.KEYCODE_TO_NOTE={90:1,88:2,67:3,86:4,66:5,78:6,77:7,65:8,83:9,68:10,188:8,190:9,192:10,70:11,71:12,72:13,74:14,75:15,76:16,187:17,81:15,87:16,69:17,82:18,84:19,89:20,85:21,73:22,79:23,80:24,49:22,50:23,51:24,52:25,53:26,54:27,55:28,56:29,57:30,48:31},this.KEYCODE_TO_NUM={49:1,50:2,51:3,52:4,53:5,54:6,55:7,56:8,57:9,48:0},this.Keyboard=function(){function e(t){this.player=t,this.mode="SYNTH",this.is_writing=!1,this.is_pressed=!1,this.last_key=0,this.solos=[],this.initEvent()}return e.prototype.initEvent=function(){return $(window).keydown(function(t){return function(e){return t.is_writing?void 0:(t.is_pressed===!1&&(t.is_pressed=!0),t.on(e))}}(this)),$(window).keyup(function(t){return function(e){return t.is_pressed=!1,t.off(e)}}(this))},e.prototype.beginInput=function(){return this.is_writing=!0},e.prototype.endInput=function(){return this.is_writing=!1},e.prototype.setMode=function(t){this.mode=t},e.prototype.on=function(t){if(t.keyCode!==this.last_key){switch(t.keyCode){case 37:this.player.view.moveLeft();break;case 38:this.player.view.moveTop();break;case 39:this.player.view.moveRight();break;case 40:this.player.view.moveBottom();break;case 32:this.player.view.viewPlay();break;case 13:this.player.view.viewPlay();break;default:"SYNTH"===this.mode&&this.onPlayer(t),"MIXER"===this.mode&&this.onMixer(t)}return this.last_key=t.keyCode}},e.prototype.onPlayer=function(t){var e;return this.player.isPlaying()&&this.player.noteOff(!0),e=KEYCODE_TO_NOTE[t.keyCode],null!=e?this.player.noteOn(e,!0):void 0},e.prototype.onMixer=function(e){var i;return(8===e.keyCode||46===e.keyCode)&&this.player.session.deleteCell(),i=KEYCODE_TO_NUM[e.keyCode],null!=i&&10>i?(t.call(this.solos,i)<0&&this.solos.push(i),this.player.solo(this.solos)):void 0},e.prototype.off=function(t){return"SYNTH"===this.mode&&this.offPlayer(t),"MIXER"===this.mode&&this.offMixer(t),this.last_key=0},e.prototype.offPlayer=function(){return this.player.noteOff(!0)},e.prototype.offMixer=function(t){var e;return e=KEYCODE_TO_NUM[t.keyCode],null!=e&&10>e?(this.solos=this.solos.filter(function(t){return t!==e}),this.player.solo(this.solos)):void 0},e}()}).call(this);